dist: xenial

language: python

matrix:
  include:
    - python: pypy3.5-7.0.0
    - python: pypy3.6-7.1.1
    - python: 3.5
    - python: 3.6
    - python: 3.7
    - python: 3.8

install:
  - python -m pip install --upgrade pip setuptools
  - python -m pip install --upgrade codecov
  - python -m pip install --force-reinstall -r requirements.txt
  - python -m pip install --force-reinstall -r requirements-tests.txt

script:
  - pytest
  - python -m doctest README.md

after_success:
  - python -m codecov -f coverage.xml -X gcov

deploy:
  provider: pypi
  on:
    tags: true
    python: 3.5
  user: __token__
  password:
    secure: VlVQSomPgZlemDZCLXnL0uZYXmqpDPCcdpujdjJpXfPAj8qK2QRsZlP2YcwOzNC5l4gsL4D9lTYXMTmQfDztZItEbpBtjWDU2kQMHTEcrrs8AuepgIsn7fD3aox9jrpeEgMj0XtpaZUztPAFNJ3TPOwnayrTrVmcyso9rGakXVW2aGgrylOi0wudv3/15c6Wt0nNllzp1ZcCPbKnMZrnWXcFVpp594HkSr3U88f5Q0JAn0S1nV9mWArv/0d52Enbc0eSYtZkxrJWkW1dRS9c6c+j5mKlbArNQJitY618fDnfWeosdEMEkbwqAehI3RaAktmngnZ+Zq3xTtdhWxEi1den6ebKt6vim+d09ZuXzsQHGs7yOqJZJKkZ+Z6YqB4zKDHHZO6Wpibz6kpoeEyAKbTw0M4ReXbV2oUaQbkYnZdh3a9VNMK9SG07LKSBPUcD8i05N8rbsi+RIE15R0iVvSl4yW0m1lzY5ZWPN4wkfda2adWiZd/IqfmNiB1JZl63n+umhqtArFFgqW+WozCnRnrN6NfllhhXf+dVK6u0zOLpXmF52CZtfb0xfo2WHRRoGnU+KIAH6Yymcb9cUjCQSLQ2cwNYuTcZ8rNv3XMuDBtD+MZ/ToUSv7hB7vLDoY2UN86vjpIrF1yRLAcGRR96v3REar4uMx+FyJopTVDwvEc=
  distributions: sdist bdist_wheel
  skip_existing: true
